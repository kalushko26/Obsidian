---
title: –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Ö—É–∫–∞—Ö `useCallback()` –∏`useMemo()`
draft: false
tags:
  - "#React"
  - "#Hooks"
  - "#useCallback"
  - "#useMemo"
info:
  - https://reactdev.ru/reference/useCallback/#usecallbackfn-dependencies
  - https://habr.com/ru/articles/579242/
---
–•—É–∫–∏¬†`useCallback()` –∏ `useMemo()`¬†- —çs—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö—É–∫–∏ –≤ React, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

### **`useMemo()`**:

**useMemo()** - —ç—Ç–æ —Ö—É–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ (–ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç) –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –µ–≥–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç). `useMemo()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–∑–æ–≤–∞ –ø–µ—Ä–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞.

```jsx
const memoizedValue = useMemo(() => computeExpensiveValue(a, b), [a, b])
```

–•—É–∫¬†`useMemo()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ,¬†`memoizedValue`¬†- —ç—Ç–æ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω—è—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏¬†`a`¬†–∏–ª–∏¬†`b`.

–í—ã–∑–æ–≤ useMemo –∏–º–µ–µ—Ç —Å–≤–æ—é —Ü–µ–Ω—É –∏ —ç—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å. –•–æ—Ä–æ—à–æ –ø—Ä–æ —Ü–µ–Ω—É —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ¬†[—Ç—É—Ç](https://youtu.be/i6DPqqbdIyw). –î–ª—è —Å–µ–±—è —è –≤—ã–≤–µ–ª —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ:

_–ï—Å–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –±–æ–ª—å—à–µ O(n), —è –∏—Å–ø–æ–ª—å–∑—É—é useMemo. –ï—Å–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∏–ª–∏ O(log n) - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é. –ü—Ä–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ö–æ—Ä–æ—à–æ —Ä–∞—Å—Å–∫–∞–∑–∞–Ω–æ¬†[—Ç—É—Ç](https://tproger.ru/articles/computational-complexity-explained/)._

**useMemo()** —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥–≤—É—Ö —Å–ª—É—á–∞—è—Ö:

1. –ö–æ–≥–¥–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è useMemo —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∏—Ö –∏ –ª–∏—à–Ω—è—è —Ä–∞–±–æ—Ç–∞ –±—É–¥–µ—Ç —É–ø—Ä–∞–∑–¥–Ω–µ–Ω–∞.
2. –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å—Å—ã–ª–æ—á–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –≤¬†**–º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π**¬†–∫–æ–º–ø–æ–Ω–µ–Ω—Ç.\*

### **`useCallback()`**:

_`useCallback()`¬†–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –µ—Å–ª–∏ –µ–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å._

_`useCallback()` –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º —Ç–æ—Ç –∂–µ `useMemo()` –∏ –ø–æ —Å—É—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–º —Å–∞—Ö–∞—Ä–æ–º._

```jsx
const memoizedCallback = useCallback(() => {
  doSomething(a, b)
}, [a, b])
```

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ,¬†`memoizedCallback`¬†- —ç—Ç–æ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ñ—É–Ω–∫—Ü–∏–∏¬†`doSomething`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω—è—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏¬†`a`¬†–∏–ª–∏¬†`b`.

_`useCallback()` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏, –Ω–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∑–∞–º—ã–∫–∞–Ω–∏—è–º–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ —Å –ø–æ–º–æ—â—å—é `useRef()`_

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–¥–Ω–æ –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π `useCallback()` - —ç—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –ø—É—Ç—ë–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø–µ—Ä–µ–¥–∞–µ—Ç–µ –¥–æ—á–µ—Ä–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º.

–ï—Å–ª–∏ –≤—ã –ø–∏—à–µ—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ö—É–∫, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±–µ—Ä–Ω—É—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç, –≤ `useCallback()`

```jsx
function useRouter() {
  const { dispatch } = useContext(RouterStateContext)

  const navigate = useCallback(
    (url) => {
      dispatch({ type: "navigate", url })
    },
    [dispatch],
  )

  const goBack = useCallback(() => {
    dispatch({ type: "back" })
  }, [dispatch])

  return {
    navigate,
    goBack,
  }
}
```

–ò–Ω–æ–≥–¥–∞ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ—Ç–µ—Ç—å –≤—ã–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤–Ω—É—Ç—Ä–∏¬†[Effect:](https://reactdev.ru/learn/synchronizing-with-effects/)

```jsx
function ChatRoom({ roomId }) {
  const [message, setMessage] = useState("")

  function createOptions() {
    return {
      serverUrl: "https://localhost:1234",
      roomId: roomId,
    }
  }

  useEffect(() => {
    const options = createOptions()
    const connection = createConnection()
    connection.connect()
    // ...
  })
}
```

–≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É.¬†[–ö–∞–∂–¥–æ–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –≤–∞—à–µ–≥–æ –≠—Ñ—Ñ–µ–∫—Ç–∞](https://reactdev.ru/learn/lifecycle-of-reactive-effects/)¬†–û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –≤—ã –æ–±—ä—è–≤–∏—Ç–µ¬†`createOptions`¬†–∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, —ç—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç –≤–∞—à –≠—Ñ—Ñ–µ–∫—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —á–∞—Ç—É:

```jsx
useEffect(() => {
  const options = createOptions()
  const connection = createConnection()
  connection.connect()
  return () => connection.disconnect()
}, [createOptions]) // üî¥ Problem: This dependency changes on every render
// ...
```

–ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –≤—ã –º–æ–∂–µ—Ç–µ –æ–±–µ—Ä–Ω—É—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –∏–∑ Effect, –≤¬†`useCallback`:

```jsx
function ChatRoom({ roomId }) {
  const [message, setMessage] = useState("")

  const createOptions = useCallback(() => {
    return {
      serverUrl: "https://localhost:1234",
      roomId: roomId,
    }
  }, [roomId]) // ‚úÖ Only changes when roomId changes

  useEffect(() => {
    const options = createOptions()
    const connection = createConnection()
    connection.connect()
    return () => connection.disconnect()
  }, [createOptions]) // ‚úÖ Only changes when createOptions changes
  // ...
}
```

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è¬†`createOptions`¬†–±—É–¥–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞–º–∏, –µ—Å–ª–∏¬†`roomId`¬†–æ–¥–∏–Ω–∞–∫–æ–≤.¬†**–û–¥–Ω–∞–∫–æ, –µ—â–µ –ª—É—á—à–µ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ—É–Ω–∫—Ü–∏–∏.**¬†–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é¬†*–≤–Ω—É—Ç—Ä—å*¬†Effect:

```jsx
function ChatRoom({ roomId }) {
  const [message, setMessage] = useState("")

  useEffect(() => {
    function createOptions() {
      // ‚úÖ No need for useCallback or function dependencies!
      return {
        serverUrl: "https://localhost:1234",
        roomId: roomId,
      }
    }

    const options = createOptions()
    const connection = createConnection()
    connection.connect()
    return () => connection.disconnect()
  }, [roomId]) // ‚úÖ Only changes when roomId changes
  // ...
}
```

–¢–µ–ø–µ—Ä—å –≤–∞—à –∫–æ–¥ —Å—Ç–∞–ª –ø—Ä–æ—â–µ –∏ –Ω–µ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤¬†`useCallback`.¬†[–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.](https://reactdev.ru/learn/removing-effect-dependencies/)

### **–û—Ç–ª–∏—á–∏—è useCallback() –∏ useMemo()**

| useCallback()                                                                                                                                | useMemo()                                                                                                                                                      |
| -------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| _–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –µ—Å–ª–∏ –µ–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å._ | _–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –µ—Å–ª–∏ –µ–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å._                         |
| _–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º_                                                                                                                   | _–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω–∏–∫–∞–º–∏ React_                                                                                                                                 |
| ---------                                                                                                                                    | _–≤–Ω—É—Ç—Ä–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥—Ä—É–≥–∏–µ —Ö—É–∫–∏, —Ç.–∫. useMemo() –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ —Å—Ç–∞–¥–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–æ–≤–æ. –ü—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ_ |
| _–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã_                                                                                                            | _–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã_                                                                                                                              |
| _–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –º–∞—Å—Å–∏–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –≤ —Å–ª—É—á–∞–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –±—É–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —Ä–µ—Ä–µ–Ω–¥–µ—Ä_                                                              | _—Ä–∞–∑—Ä–µ—à–µ–Ω undefined, –Ω–æ –Ω–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å –µ–≥–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º_                                                                                                        |

`useCallback()` - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –º–∞—Å—Å–∏–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å. `useMemo()` - —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫–∂–µ, –Ω–æ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π.

---

[[004 ReactCore|–ù–∞–∑–∞–¥]]